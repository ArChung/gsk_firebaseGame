webpackJsonp([1],{AkP4:function(t,e){},NHnr:function(t,e,s){"use strict";Object.defineProperty(e,"__esModule",{value:!0});var a=s("7+uW"),n={render:function(){var t=this.$createElement,e=this._self._c||t;return e("div",{attrs:{id:"app"}},[e("router-view")],1)},staticRenderFns:[]};var i=s("VU/8")({name:"App"},n,!1,function(t){s("yZ0u")},null,null).exports,o=s("/ocq"),r=s("mtWM"),c=s.n(r),l=s("kxiW"),u=s.n(l),d={name:"Game",data:function(){return{channel:0,answers:[1,2,3,1,2,3,1,2,3,1,2,3,1,2,3],questions:[1,2,3,4,5,6,7,8,9,10,11,12,13,14,15],userAnsNow:-1,totalTime:0,totalQuestions:5,score:0,userChoosed:!1,timeLeft:10}},computed:{question:function(){return this.questions[this.channel-1]},answer:function(){return this.answers[this.question-1]},rightAns:function(){return-1===this.userAnsNow?-1:this.answer},wrongAns:function(){return-1!==this.userAnsNow&&this.userAnsNow!=this.answer?this.userAnsNow:-1}},mounted:function(){console.log("game mounted"),this.questions=this.shuffleArray(this.questions),this.startPlayTime(),this.nextQuestion()},created:function(){console.log("game created")},methods:{chooseAnswer:function(t){var e=this;this.userChoosed||(clearInterval(this.answerTimer),this.userAnsNow=t,this.userChoosed=!0,this.userAnsNow===this.answer&&(this.score=Math.floor(100/this.totalQuestions)+this.score),setTimeout(function(){e.nextQuestion()},1500))},nextQuestion:function(){this.channel>=this.totalQuestions?this.endGame():(this.channel+=1,this.userAnsNow=-1,this.userChoosed=!1,this.startAnswerTimer())},startAnswerTimer:function(){var t=this;t.timeLeft=10,t.answerTimer=setInterval(function(){t.timeLeft<=0?t.chooseAnswer(4):t.timeLeft-=1},1e3)},startPlayTime:function(){var t=this;t.totalTime=0,t.playTimer=setInterval(function(){t.totalTime+=1},1e3)},endGame:function(){clearInterval(this.playTimer),console.log("game ended"),this.$emit("gameover",{playTime:this.totalTime,score:this.score})},shuffleArray:function(t){for(var e=t.slice(0),s=e.length-1;s>0;s--){var a=Math.floor(Math.random()*(s+1)),n=e[s];e[s]=e[a],e[a]=n}return e}}},v={render:function(){var t=this,e=t.$createElement,s=t._self._c||e;return s("div",{staticClass:"container"},[s("div",{staticClass:"info"},[s("p",[t._v("\n      channel : "+t._s(t.channel)+"\n    ")]),t._v(" "),s("p",[t._v("\n      quesNo. : "+t._s(t.question)+"\n    ")]),t._v(" "),s("p",[t._v("\n      answer  : "+t._s(t.answer)+"\n    ")]),t._v(" "),s("p",[t._v("\n      score: "+t._s(t.score)+"\n    ")]),t._v(" "),s("p",[t._v("\n      userAnsNow : "+t._s(t.userAnsNow)+"\n    ")]),t._v(" "),s("p",[t._v("\n      right: "+t._s(t.rightAns)+" , wrong: "+t._s(t.wrongAns)+"\n    ")]),t._v(" "),s("p",[t._v("\n      time: "+t._s(t.timeLeft)+"\n    ")])]),t._v(" "),s("div",{staticClass:"gameBox"},[s("div",{staticClass:"optionBox"},[s("div",{staticClass:"option op1 btn",class:[{right:1==t.rightAns},{wrong:1==t.wrongAns}],on:{click:function(e){t.chooseAnswer(1)}}},[t._v("1")]),t._v(" "),s("div",{staticClass:"option op2 btn",class:[{right:2==t.rightAns},{wrong:2==t.wrongAns}],on:{click:function(e){t.chooseAnswer(2)}}},[t._v("2")]),t._v(" "),s("div",{staticClass:"option op3 btn",class:[{right:3==t.rightAns},{wrong:3==t.wrongAns}],on:{click:function(e){t.chooseAnswer(3)}}},[t._v("3")])]),t._v(" "),s("div",{staticClass:"btn",on:{click:function(e){t.nextQuestion()}}},[t._v("next")]),t._v(" "),s("div",{staticClass:"btn",on:{click:t.endGame}},[t._v("test")])])])},staticRenderFns:[]};var h={name:"HelloWorld",data:function(){return{pageChannel:"video",loading:!1,pageChannelArr:["video","form","rule","game","board","finish","Ingredients","ice"],iceArr:[],userData:{hospital:"hospital",username:"brook",photoName:"test.png",score:0,playTime:0},serialNumber:"",userphoto:null,userBoardPhoto:"",videoId:"",videoArr:["SfKQ9H0MWM0","rQgytvHzark"],videoVars:{autoplay:1,rel:0,showInfo:0},scoreList:[]}},watch:{iceArr:function(t){console.log(t),t.length>3&&this.iceArr.shift()},userPhoto:function(t){console.log(t)}},computed:{sortScoreList:function(){return this.scoreList.sort(function(t,e){return e.score-t.score||t.playTime-e.playTime})}},mounted:function(){},created:function(){console.log("created"),this.getUrlVideoId(),this.initFirebase()},methods:{playerEnd:function(){this.pageChannel="form"},gameover:function(t){console.log(t.playTime,t.score),this.userData.score=t.score,this.userData.playTime=t.playTime,this.uploadUserData()},onPhotoSelected:function(t){var e=this;this.userphoto=t.target.files[0];var s=new FileReader;s.onload=function(){e.userBoardPhoto=s.result},s.readAsDataURL(t.target.files[0])},uploadPhoto:function(t){var e=this;if(null!=this.userphoto&&""!=this.userData.username&&""!=this.userData.hospital){this.pageChannel=this.pageChannelArr[2];var s=new FormData;s.append("myFile",this.userphoto,this.userphoto.name),c.a.post("https://us-central1-gsk-319c7.cloudfunctions.net/uploadFile",s).then(function(t){console.log(t),e.userData.photoName=t.data.data})}else alert("請完成表單")},uploadUserData:function(){var t=this;console.log("upload data"),this.database.push(this.userData).then(function(e){t.pageChannel=t.pageChannelArr[4],t.getBoardData()})},getUrlVideoId:function(){var t=+this.$route.query.vIndex-1;console.log(t),NaN!=t?(t=t<this.videoArr.length?t:0,this.videoId=this.videoArr[t],console.log(this.videoId)):(console.log("NaN"),this.videoId=this.videoArr[0])},initFirebase:function(){u.a.initializeApp({apiKey:"AIzaSyAfSyBKDOds7c5qRLRHHg2Ug3RHLpNj_HE",authDomain:"gsk-319c7.firebaseapp.com",databaseURL:"https://gsk-319c7.firebaseio.com",projectId:"gsk-319c7",storageBucket:"gsk-319c7.appspot.com",messagingSenderId:"735059452550"}),this.database=u.a.database().ref("posts/"),this.serialDatabase=u.a.database().ref("serialNumber"),this.storage=u.a.storage()},goIngredients:function(){this.getSerialNumber(),this.pageChannel="Ingredients"},getBoardData:function(){this.loading=!0;var t=this,e=this.storage;this.database.limitToLast(10).once("value",function(s){var a=[];s.forEach(function(t){a.unshift(t.val())}),function(s){var a=0;!function n(){if(a>=s.length)return console.log(s),t.scoreList=s,void(t.loading=!1);var i=e.ref("resized-"+s[a].photoName);i.getDownloadURL().then(function(t){s[a].photoName=t,a++,n()})}()}(a)})},addIngredient:function(t){var e=this.iceArr.indexOf(t),s=this.iceArr;if(-1!=e)s.splice(e,1);else{if(s.length>=3)return;s.push(t)}},getSerialNumber:function(){var t=this;this.serialDatabase.once("value",function(e){t.serialNumber=1+e.val(),t.serialDatabase.set(t.serialNumber),t.serialNumber=t.addZero(4,t.serialNumber)})},addZero:function(t,e){for(var s=t;s>0;)e="0"+e,s--;return e.slice(-t)}},components:{Game:s("VU/8")(d,v,!1,function(t){s("AkP4")},"data-v-e5c53ca6",null).exports}},p={render:function(){var t=this,e=t.$createElement,s=t._self._c||e;return s("div",{staticClass:"container"},[1==t.loading?s("div",{staticClass:"page loading"},[s("div",{staticClass:"loadingContainer"},[t._v("\n      計算成績ing\n    ")])]):t._e(),t._v(" "),"video"==t.pageChannel?s("div",{staticClass:"page",attrs:{id:"video"}},[s("youtube",{attrs:{"video-id":t.videoId,"player-vars":t.videoVars,"player-width":"100%","player-height":"100%"},on:{ended:t.playerEnd}}),t._v(" "),s("div",{staticClass:"btn",on:{click:t.playerEnd}},[t._v("skip")])],1):t._e(),t._v(" "),"form"==t.pageChannel?s("div",{staticClass:"page",attrs:{id:"form"}},[s("div",{staticClass:"pageContainer"},[s("div",{staticClass:"inputWrap"},[s("input",{directives:[{name:"model",rawName:"v-model",value:t.userData.hospital,expression:"userData.hospital"}],staticClass:"textInput",attrs:{type:"text",placeholder:"hospital"},domProps:{value:t.userData.hospital},on:{input:function(e){e.target.composing||t.$set(t.userData,"hospital",e.target.value)}}}),t._v(" "),s("br"),t._v(" "),s("input",{directives:[{name:"model",rawName:"v-model",value:t.userData.username,expression:"userData.username"}],staticClass:"textInput",attrs:{type:"text",placeholder:"name"},domProps:{value:t.userData.username},on:{input:function(e){e.target.composing||t.$set(t.userData,"username",e.target.value)}}}),t._v(" "),s("br"),t._v(" "),s("input",{ref:"photoBtn",staticStyle:{display:"none"},attrs:{type:"file",accept:"image/*",id:"capture",capture:"camera"},on:{change:t.onPhotoSelected}}),t._v(" "),s("br"),t._v(" "),s("div",{staticClass:"btn",on:{click:function(e){t.$refs.photoBtn.click()}}},[t._v("photo")]),t._v(" "),s("br"),t._v(" "),s("div",{staticClass:"btn",on:{click:t.uploadPhoto}},[t._v("uploadPic & go rule ")]),t._v(" "),s("br"),t._v(" "),s("div",{staticClass:"btn",on:{click:t.uploadUserData}},[t._v("upload Data ")])])])]):t._e(),t._v(" "),"rule"==t.pageChannel?s("div",{staticClass:"page",attrs:{id:"rule"}},[s("div",{staticClass:"pageContainer"},[s("div",{staticClass:"btn",on:{click:function(e){t.pageChannel="game"}}},[t._v("play")])])]):t._e(),t._v(" "),"game"==t.pageChannel?s("div",{staticClass:"page",attrs:{id:"game"}},[s("div",{staticClass:"pageContainer"},[s("Game",{on:{gameover:t.gameover}})],1)]):t._e(),t._v(" "),"board"==t.pageChannel?s("div",{staticClass:"page",attrs:{id:"board"}},[s("div",{staticClass:"pageContainer"},[s("div",{staticClass:"manContainer"},[t._l(t.sortScoreList,function(e,a){return s("div",{key:a,staticClass:"man"},[s("span",{staticClass:"u_pic",style:{backgroundImage:"url("+e.photoName+")"}}),t._v(" "),s("span",{staticClass:"u_name"},[t._v(t._s(e.username))]),t._v(" "),s("span",{staticClass:"u_scroe"},[t._v(" "+t._s(e.score))]),t._v(" "),s("span",{staticClass:"u_playtime"},[t._v(t._s(e.playTime))])])}),t._v(" "),s("div",{staticClass:"user man"},[s("span",{staticClass:"u_pic",style:{backgroundImage:"url("+t.userBoardPhoto+")"}}),t._v(" "),s("span",{staticClass:"u_name"},[t._v(t._s(t.userData.username))]),t._v(" "),s("span",{staticClass:"u_scroe"},[t._v(" "+t._s(t.userData.score))]),t._v(" "),s("span",{staticClass:"u_playtime"},[t._v(t._s(t.userData.playTime))])])],2),t._v(" "),s("div",{staticClass:"btn",on:{click:t.goIngredients}},[t._v("finish")])])]):t._e(),t._v(" "),"finish"==t.pageChannel?s("div",{staticClass:"page",attrs:{id:"finish"}},[s("div",{staticClass:"pageContainer"},[s("div",{staticClass:"btn",on:{click:function(e){t.pageChannel="Ingredients"}}},[t._v("Ingredients")])])]):t._e(),t._v(" "),"Ingredients"==t.pageChannel?s("div",{staticClass:"page",attrs:{id:"Ingredients"}},[s("div",{staticClass:"pageContainer"},[s("div",{staticClass:"ice"},[-1!=t.iceArr.indexOf(1)?s("div",{staticClass:"Ingredient ing1 "},[t._v("1")]):t._e(),t._v(" "),-1!=t.iceArr.indexOf(2)?s("div",{staticClass:"Ingredient ing2 "},[t._v("2")]):t._e(),t._v(" "),-1!=t.iceArr.indexOf(3)?s("div",{staticClass:"Ingredient ing3 "},[t._v("3")]):t._e(),t._v(" "),-1!=t.iceArr.indexOf(4)?s("div",{staticClass:"Ingredient ing4 "},[t._v("4")]):t._e(),t._v(" "),-1!=t.iceArr.indexOf(5)?s("div",{staticClass:"Ingredient ing5 "},[t._v("5")]):t._e(),t._v(" "),-1!=t.iceArr.indexOf(6)?s("div",{staticClass:"Ingredient ing5 "},[t._v("6")]):t._e()]),t._v(" "),s("div",{staticClass:"iceBtn"},[s("div",{staticClass:"btn",on:{click:function(e){t.addIngredient(1)}}},[t._v("ing1")]),t._v(" "),s("div",{staticClass:"btn",on:{click:function(e){t.addIngredient(2)}}},[t._v("ing2")]),t._v(" "),s("div",{staticClass:"btn",on:{click:function(e){t.addIngredient(3)}}},[t._v("ing3")]),t._v(" "),s("div",{staticClass:"btn",on:{click:function(e){t.addIngredient(4)}}},[t._v("ing4")]),t._v(" "),s("div",{staticClass:"btn",on:{click:function(e){t.addIngredient(5)}}},[t._v("ing5")]),t._v(" "),s("div",{staticClass:"btn",on:{click:function(e){t.addIngredient(6)}}},[t._v("ing6")])]),t._v(" "),s("div",{staticClass:" btn",on:{click:function(e){t.pageChannel="ice"}}},[t._v("ice")])])]):t._e(),t._v(" "),"ice"==t.pageChannel?s("div",{staticClass:"page",attrs:{id:"ice"}},[s("div",{staticClass:"pageContainer"},[s("p",[t._v("\n        "+t._s(t.serialNumber)+"\n      ")])])]):t._e()])},staticRenderFns:[]};var g=s("VU/8")(h,p,!1,function(t){s("phWh")},"data-v-3d44967a",null).exports;a.a.use(o.a);var _=new o.a({routes:[{path:"/",name:"HelloWorld",component:g}]}),f=s("5/be");a.a.use(f.a),a.a.config.productionTip=!1,new a.a({el:"#app",router:_,components:{App:i},template:"<App/>"})},phWh:function(t,e){},yZ0u:function(t,e){}},["NHnr"]);
//# sourceMappingURL=app.39dc3e189ecf0919a9dc.js.map